# Домашнее задание к занятию "`Базы данных, их типы`" - `Avvakumov Oleg`


### Задание 1. СУБД

`Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?`

1.1. `Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.`

1.1.*`Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?`

1.2. `Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.`

1.2.*`Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?`

1.3. `Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.`

1.3.*`Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?`

1.4. `Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.`

1.4.*`Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?`

1.5.*`Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?`

`Приведите ответ в свободной форме.`

### Решение
*
1.1  `Реляционная СУБД (например, PostgreSQL/MS SQL/Oracle), так как требуется строгая структура, гарантированная целостность данных и транзакционность (ACID).`
1.1* `Для ускорения при длительном хешировании/тяжёлых повторяющихся операций можно использовать API кэширования: Redis или Memcached.`
1.2  `Лендинги: документо-ориентированная NoSQL (например, MongoDB) — гибкость схемы и высокая скорость изменений.
      CRM: реляционная (если важны связи и строгая модель) или документо-ориентированная NoSQL (если приоритет гибкости и быстрого расширения сущностей).`
1.2* `Да, можно одной СУБД. Наиболее универсальный вариант — PostgreSQL как единая корпоративная платформа под разные сущности/модули. Альтернатива в сторону максимальной гибкости — MongoDB.`
1.3  `Иерархическая СУБД, так как структура норм/правил/обучающих материалов естественно укладывается в модель “дерево” по оргструктуре компании.`
1.3* `Да. Можно использовать СУБД из задач 1.1/1.2, выделив отдельную базу/схему (в реляционной) или отдельные коллекции (в документо-ориентированной).`
1.4  `Графовая СУБД (например, Neo4j), так как требуется высокая скорость работы со сложными связями при построении маршрутов и распределении курьеров.`
1.4* `Отдел закупок лучше оставить на реляционной СУБД и интегрировать с графовой логистов, поскольку закупки требуют строгой модели данных и транзакционной целостности.`
1.5  `Теоретически да. Наиболее подходящий кандидат “одна СУБД на всё” — PostgreSQL как универсальная платформа.
      Практически правильнее использовать разные типы СУБД под разные предметные области (полиглотное хранение).`
*

---

### Задание 2. Транзакции


2.1. `Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.`

2.1.* `Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?`

### Решение
* 
2.1 `Пользователь пополняет баланс счёта телефона`

1. `Инициация операции
   Пользователь вводит номер телефона и сумму, подтверждает платёж. Система формирует платёжное поручение.`

2. `Старт транзакции
   Приложение/платёжный сервис открывает транзакцию в БД.`

3. `Проверки и валидация
   Проверяются параметры операции: корректность номера, допустимость суммы, наличие достаточных средств на источнике списания, отсутствие блокировок/лимитов.`

4. `Запись изменений
   Выполняются согласованные изменения данных:
   - списание суммы с источника (карта/кошелёк/лицевой счёт),
   - зачисление суммы на баланс телефона.`

5. `Фиксация результатов и журналирование
Записывается факт операции (платёж, статус, время, идентификаторы), формируется запись для аудита/истории операций.`

6. `COMMIT
   Транзакция фиксируется. Пользователь получает подтверждение об успешном пополнении.`

`Если на любом из шагов 3–5 возникает ошибка, выполняется ROLLBACK, и данные возвращаются к исходному состоянию.`

2.1* `Если пополнение происходило бы через автоплатёж`

1. `Срабатывание правила автоплатежа
   По расписанию или по условию (например, баланс ниже порога) система инициирует платёж автоматически.`

2. `Старт транзакции
   Платёжный сервис открывает транзакцию в БД.`

3. `Проверка условий автоплатежа
   Проверяются: активность автоплатежа, лимиты, порог/расписание, валидность привязанного источника, достаточность средств.`

4. `Запись изменений
   Согласованные изменения: списание с источника + зачисление на баланс телефона.`

5. `Фиксация результатов и журналирование
   Запись в историю именно как “автоплатёж”, сохранение статуса, причины отказа при сбое.`

6. `COMMIT
   Транзакция фиксируется; пользователю отправляется уведомление.`

`При любой ошибке — ROLLBACK и запись статуса “неуспешно” с причиной (например, недостаточно средств/превышен лимит/источник недоступен).`
*
---

### Задание 3

`Задание 3. SQL vs NoSQL`
3.1. `Напишите пять преимуществ SQL-систем по отношению к NoSQL.`

3.1.* `Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.`

### Решение

3.1 * `Пять преимуществ SQL-систем по отношению к NoSQL`

- `Строгая схема данных и предсказуемая модель.
   В реляционных СУБД данные организованы в таблицы и описываются заранее заданной структурой, что упрощает контроль качества данных.`
- `Гарантия целостности и согласованности.
   Реляционные системы ориентированы на поддержание целостности данных в рамках транзакционной модели.`
- `Полноценные транзакции по ACID.
   Это даёт надёжность в финансовых и критичных бизнес-операциях: “всё или ничего”, изоляция, долговечность.`
- `Стандартный язык запросов SQL.
   Унифицированный язык работы с данными повышает переносимость навыков и решений между платформами.`
- `Лучше подходит для сложных взаимосвязанных структур и строгой отчётности.
   Реляционная модель естественно поддерживает системное описание сущностей и их отношений в табличной форме, что удобно для аналитики и регламентной отчётности.`


3.1* `Преимущества NewSQL перед SQL и NoSQL`

- `Сохраняет ACID как у классических SQL-систем, что важно для критичных транзакций.`
- `Стремится дать горизонтальную масштабируемость и производительность, близкую к NoSQL-подходам, при сохранении транзакционной строгости. (Логическое позиционирование NewSQL как попытки объединить сильные стороны SQL и NoSQL; 
   у NoSQL акценты — гибкость/масштабируемость/производительность.)`  
- `Удобен для современных высоконагруженных OLTP-сценариев, где нужны и строгая консистентность, и масштабирование.`


---
### Задание 4

`Кластеры. Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин.
 На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?`

### Решение

*`Критерий выбора — приоритеты CAP для распределённой системы (что важнее: согласованность или доступность при неизбежной распределённости).`*
*`Тип СУБД — NoSQL с горизонтальным масштабированием; оптимально column-oriented для задач big data.`*
*`Модель распределённых вычислений — MapReduce, так как она предназначена для массовой параллельной обработки больших объёмов данных на множестве узлов.`*


